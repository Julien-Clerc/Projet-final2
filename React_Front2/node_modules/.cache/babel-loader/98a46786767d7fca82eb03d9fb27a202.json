{"ast":null,"code":"var _jsxFileName = \"/home/julien/Rendu/ETP/Git/C-COD-260-LYN-2-1-ecp-julien.clerc/React_Front2/src/components/profile.component.js\";\nimport React, { Component, useState, useEffect } from \"react\";\nimport { Redirect } from 'react-router-dom';\nimport { connect } from \"react-redux\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Profile extends Component {\n  constructor(props) {\n    super(props);\n    this.onChangeUsername = this.onChangeUsername.bind(this);\n    this.onChangeEmail = this.onChangeEmail.bind(this);\n    this.onChangePassword = this.onChangePassword.bind(this);\n    this.onChangeCFPassword = this.onChangeCFPassword.bind(this);\n    this.handleUpdateProfile = this.handleUpdateProfile.bind(this);\n    this.state = {\n      avatar: '',\n      username: '',\n      email: '',\n      password: '',\n      cf_password: ''\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      username: this.props.user.username,\n      email: this.props.user.email\n    });\n  }\n\n  onChangeUsername(e) {\n    this.setState({\n      username: e.target.value\n    });\n  }\n\n  onChangeEmail(e) {\n    this.setState({\n      email: e.target.value\n    });\n  }\n\n  onChangePassword(e) {\n    this.setState({\n      password: e.target.value\n    });\n  }\n\n  onChangeCFPassword(e) {\n    this.setState({\n      cf_password: e.target.value\n    });\n  }\n\n  handleUpdateProfile(e) {\n    e.preventDefault();\n    const {\n      username,\n      email,\n      password,\n      cf_password\n    } = this.state;\n\n    if (password) {\n      // console.log(\"mdp\", password)\n      this.updatePassword(password, cf_password);\n    }\n\n    if (username !== this.props.user.username || email !== this.props.user.email) {\n      // console.log(\"nom\", username)\n      this.updateProfile(username, email);\n    }\n\n    if (email) {// console.log(\"email\", email)\n    }\n  }\n\n  updatePassword(password, cf_password) {\n    if (password.length < 6 || password.length > 40) {\n      console.log(\"err: password must be between 6 and 40\");\n    }\n\n    if (password !== cf_password) {\n      console.log(\"err: password must match confirmation\");\n    }\n\n    if (!(password.length < 6 || password.length > 40) && !(password !== cf_password)) {//   fetch('http://localhost:8087/user/'+this.props.user.id, {\n      //   method: 'PUT',\n      //   headers: {'Content-Type': 'application/json'},\n      //   body: JSON.stringify({password: password})\n      // })\n      // .then(res => res.json())\n      // .then(data => console.log(data))\n      // .catch(err => console.log(err))\n    }\n  }\n\n  async updateProfile(username, email) {\n    const data = {};\n    if (username !== this.props.user.username) data['username'] = username;\n    if (email !== this.props.user.email) data['email'] = email;\n    console.log(data);\n    fetch('http://localhost:8087/user/' + this.props.user.id, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    }).then(res => res.json()).then(data => console.log(data)).catch(err => console.log(err));\n  }\n\n  render() {\n    const {\n      user: currentUser\n    } = this.props;\n\n    if (!currentUser) {\n      return /*#__PURE__*/_jsxDEV(Redirect, {\n        to: \"/login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 14\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"jumbotron\",\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: currentUser.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 13\n          }, this), \" Profile\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Token:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 11\n        }, this), \" \", currentUser.accessToken, \" ...\", \" \", currentUser.accessToken]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Id:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this), \" \", currentUser.id]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Email:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 11\n        }, this), \" \", currentUser.email, \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 55\n        }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Service:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 11\n        }, this), \" \", currentUser.service]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Authorities:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: currentUser.roles && currentUser.roles.map((role, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: role\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 52\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"row text-secondary\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-center text-uppercase\",\n            children: \"'User Profile'\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"avatar\",\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-camera\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Change\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 166,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"file\",\n                name: \"file\",\n                id: \"file_up\",\n                accept: \"image/*\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"username\",\n              children: \"Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"username\",\n              value: this.state.username,\n              className: \"form-control\",\n              placeholder: \"Your username\",\n              onChange: this.onChangeUsername\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"email\",\n              children: \"Email\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"email\",\n              value: this.state.email,\n              className: \"form-control\",\n              onChange: this.onChangeEmail\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"password\",\n              children: \"New Password\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"password\",\n              name: \"password\",\n              value: this.password,\n              className: \"form-control\",\n              placeholder: \"Your new password\",\n              onChange: this.onChangePassword\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"cf_password\",\n              children: \"Confirm New Password\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"password\",\n              name: \"cf_password\",\n              value: this.cf_password,\n              className: \"form-control\",\n              placeholder: \"Confirm new password\",\n              onChange: this.onChangeCFPassword\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-info\",\n            onClick: this.handleUpdateProfile,\n            children: \"Update\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Services available\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 21\n          }, this), this.state.username, this.state.email]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  const {\n    user\n  } = state.auth;\n  return {\n    user\n  };\n}\n\nexport default connect(mapStateToProps)(Profile);","map":{"version":3,"sources":["/home/julien/Rendu/ETP/Git/C-COD-260-LYN-2-1-ecp-julien.clerc/React_Front2/src/components/profile.component.js"],"names":["React","Component","useState","useEffect","Redirect","connect","Profile","constructor","props","onChangeUsername","bind","onChangeEmail","onChangePassword","onChangeCFPassword","handleUpdateProfile","state","avatar","username","email","password","cf_password","componentDidMount","setState","user","e","target","value","preventDefault","updatePassword","updateProfile","length","console","log","data","fetch","id","method","headers","body","JSON","stringify","then","res","json","catch","err","render","currentUser","accessToken","service","roles","map","role","index","mapStateToProps","auth"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect } from \"react\";\nimport { Redirect } from 'react-router-dom';\nimport { connect } from \"react-redux\";\n\n\nclass Profile extends Component {\n\n  \n  constructor(props) {\n    super(props);\n\n    this.onChangeUsername = this.onChangeUsername.bind(this);\n    this.onChangeEmail = this.onChangeEmail.bind(this);\n    this.onChangePassword = this.onChangePassword.bind(this);\n    this.onChangeCFPassword = this.onChangeCFPassword.bind(this);\n    this.handleUpdateProfile = this.handleUpdateProfile.bind(this);\n\n    this.state = {\n      avatar: '',\n      username: '',\n      email: '',\n      password: '',\n      cf_password: ''\n    }\n  }\n\n  componentDidMount() {\n    this.setState({\n      username: this.props.user.username,\n      email: this.props.user.email,\n    })\n  };\n\n\n  onChangeUsername(e) {\n    this.setState({\n      username: e.target.value,\n    });\n  };\n\n  onChangeEmail(e) {\n    this.setState({\n      email: e.target.value,\n    });\n  };\n\n  onChangePassword(e) {\n    this.setState({\n      password: e.target.value,\n    });\n  };\n\n  onChangeCFPassword(e) {\n    this.setState({\n      cf_password: e.target.value,\n    });\n  };\n\n  handleUpdateProfile(e) {\n\n    e.preventDefault();\n\n    const { username, email, password, cf_password } = this.state\n\n    if (password) {\n      // console.log(\"mdp\", password)\n      this.updatePassword(password, cf_password);\n    }\n\n    if (username !== this.props.user.username || email !== this.props.user.email) {\n      // console.log(\"nom\", username)\n      this.updateProfile(username, email);\n    }\n    if (email) {\n      // console.log(\"email\", email)\n    }\n  }\n\n  updatePassword(password, cf_password) {\n    if (password.length < 6 || password.length > 40) {\n      console.log(\"err: password must be between 6 and 40\")\n    }\n    if (password !== cf_password) {\n      console.log(\"err: password must match confirmation\")\n    }\n\n    if (!(password.length < 6 || password.length > 40) && !(password !== cf_password )) {\n\n    //   fetch('http://localhost:8087/user/'+this.props.user.id, {\n    //   method: 'PUT',\n    //   headers: {'Content-Type': 'application/json'},\n    //   body: JSON.stringify({password: password})\n    // })\n    // .then(res => res.json())\n    // .then(data => console.log(data))\n    // .catch(err => console.log(err))\n    }\n\n  }\n\n  async updateProfile(username, email) {\n\n    const data = {}\n\n    if (username !== this.props.user.username) data['username'] = username\n    if (email !== this.props.user.email) data['email'] = email\n\n    console.log(data);\n\n    fetch('http://localhost:8087/user/'+this.props.user.id, {\n      method: 'PUT',\n      headers: {'Content-Type': 'application/json'},\n      body: JSON.stringify(data)\n    })\n    .then(res => res.json())\n    .then(data => console.log(data))\n    .catch(err => console.log(err))\n\n  }\n  \n\n  render() {\n\n    const { user: currentUser } = this.props;\n\n    if (!currentUser) {\n      return <Redirect to=\"/login\" />;\n    }\n\n    \n\n    return (\n      <div className=\"container\">\n        <header className=\"jumbotron\">\n          <h3>\n            <strong>{currentUser.username}</strong> Profile\n          </h3>\n        </header>\n        <p>\n          <strong>Token:</strong> {currentUser.accessToken} ...{\" \"}\n          {currentUser.accessToken}\n        </p>\n        <p>\n          <strong>Id:</strong> {currentUser.id}\n        </p>\n        <p>\n          <strong>Email:</strong> {currentUser.email} <br />\n          <strong>Service:</strong> {currentUser.service}\n        </p>\n        <strong>Authorities:</strong>\n        <ul>\n          {currentUser.roles &&\n            currentUser.roles.map((role, index) => <li key={index}>{role}</li>)}\n        </ul>\n\n        <section className=\"row text-secondary\">\n                <div className=\"col-md-4\">\n                    <h3 className=\"text-center text-uppercase\">\n                         'User Profile' \n\n                    </h3>\n                    <div className=\"avatar\">\n                        {/* <img src=\"\" alt=\"avatar\" /> */}\n                        <span>\n                            <i className=\"fas fa-camera\"></i>\n                            <p>Change</p>\n                            <input type=\"file\" name=\"file\" id=\"file_up\" \n                            accept=\"image/*\"  />\n                        </span>\n                    </div>\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"username\">Name</label>\n                        <input type=\"text\" name=\"username\" value={this.state.username} className=\"form-control\"\n                        placeholder=\"Your username\" onChange={this.onChangeUsername} />\n                    </div>\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"email\">Email</label>\n                        <input type=\"text\" name=\"email\"  value={this.state.email}\n                        className=\"form-control\" onChange={this.onChangeEmail} />\n                    </div>\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"password\">New Password</label>\n                        <input type=\"password\" name=\"password\" value={this.password} className=\"form-control\"\n                        placeholder=\"Your new password\" onChange={this.onChangePassword}/>\n                    </div>\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"cf_password\">Confirm New Password</label>\n                        <input type=\"password\" name=\"cf_password\" value={this.cf_password} className=\"form-control\"\n                        placeholder=\"Confirm new password\" onChange={this.onChangeCFPassword}/>\n                    </div>\n\n                    <button className=\"btn btn-info\" onClick={this.handleUpdateProfile}>\n                        Update\n                    </button>\n\n                </div>\n\n                <div className=\"col-md-8\">\n                    <h3>Services available</h3>\n                    {this.state.username}\n                    {this.state.email}\n                </div>\n            </section>\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps(state) {\n  const { user } = state.auth;\n  return {\n    user,\n  };\n}\n\nexport default connect(mapStateToProps)(Profile);"]},"metadata":{},"sourceType":"module"}